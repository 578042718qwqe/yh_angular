<html>
<head>
    <meta charset="UTF-8">
    <title>基础框架</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/index.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <script type="text/javascript" src="js/angular/jquery.min.js"></script>
    <script type="text/javascript" src="js/angular/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/angular/angular.min.js"></script>
    <script type="text/javascript" src="js/angular/angular-ui-router.min.js"></script>
    <script type="text/javascript" src="js/angular/angular-animate.js"></script>
    <script type="text/javascript" src="js/path.js"></script>
    <script src="js/cookies/angular-cookies.js"></script>
    <script src="js/cookies/jquery.cookie.min.js"></script>
    <!--可编辑表格注入-->
    <link rel="stylesheet" href="http://ui-grid.info/release/ui-grid.css" type="text/css">
    <script type="text/javascript" src="js/ui-grid-angular/csv.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/pdfmake.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/vfs_fonts.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/lodash.min.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/jszip.min.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/excel-builder.dist.js"></script>
    <script type="text/javascript" src="js/ui-grid-angular/ui-grid.js"></script>
    <!--时间控件-->
    <script language="javascript" type="text/javascript" src="js/My97DatePicker/WdatePicker.js"></script>
    <!--自定义-->
    <script type="text/javascript" src="js/index.js" language="javascript"></script>
    <script type="text/javascript" src="js/router.js"></script>
    <!--提示弹框-->
    <script src="js/sweetalert/sweetalert.min.js"></script>
    <!--导航栏-->
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/hds-ace.css" rel="stylesheet">
    <script type="text/javascript" src="js/nav.js"></script>
    <!--table-->
    <script type="text/javascript" src="js/table.js"></script>
    <!--ui-boostarp-->
    <script type="text/javascript" src="js/custom.js"></script>
    <script src="https://cdn.bootcss.com/angular.js/1.5.0/angular-animate.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-sanitize.js"></script>
    <script src="http://cdn.bootcss.com/angular-ui-bootstrap/1.1.2/ui-bootstrap-tpls.js"></script>
    <!--ui-sortable-->
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://rawgithub.com/angular-ui/ui-sortable/master/src/sortable.js"></script>
</head>
<body>
<input id="input1">
<script>
    $.fn.extend({
        alertWhileClick:function() {
            $(this).click(function(){
                alert($(this).val());
            });
        }
    });
    $("#input1").alertWhileClick(); // 页面上为：
</script>
</body>
<script>
    //*--------------------------------公用表格模块------------------------------------------//
    routerApp.controller('MainCtrl', ['$scope', '$http', '$timeout','data', function ($scope, $http, $timeout,data,opt1) {

        $scope.delet =function (index) {
            $scope.gridOptions.data.splice(index,1)
        };
        $scope.searchGrid = function(){
            $scope.objseach ={

            };
            $scope.objseach.objseach = $("#objseach").val();
            $scope.objseach.begintime = $("#monthCtrlStart").val();
            $scope.objseach.endtime = $("#monthCtrlEnd").val();
            console.log($scope.objseach)
        };
        $scope.gridOptions = {

        };

        $scope.storeFile = function( gridRow, gridCol, files ) {
            // ignore all but the first file, it can only select one anyway
            // set the filename into this column
            gridRow.entity.filename = files[0].name;

            // read the file and set it into a hidden column, which we may do stuff with later
            var setFile = function(fileContent){
                gridRow.entity.file = fileContent.currentTarget.result;
                // put it on scope so we can display it - you'd probably do something else with it
                $scope.lastFile = fileContent.currentTarget.result;
                $scope.$apply();
            };
            var reader = new FileReader();
            reader.onload = setFile;
            reader.readAsText( files[0] );
        };
        $scope.useExternalSorting = false;
        $scope.gridOptions.paginationPageSizes = [50, 100, 500];
        $scope.gridOptions.paginationPageSize = 30;
        $scope.gridOptions.columnDefs = [
            { name: 'name', displayName: 'Name', width: '20%' },
            { name: 'age', displayName: 'Age' , type: 'number', width: '10%' },
            { name: 'gender', displayName: 'Gender', editableCellTemplate: 'ui-grid/dropdownEditor', width: '10%',
                cellFilter: 'mapGender', editDropdownValueLabel: 'gender', editDropdownOptionsArray: [
                { id: 1, gender: 'male' },
                { id: 2, gender: 'female' }
            ] },
            { name: 'registered', displayName: 'Registered' , type: 'date', cellFilter: 'date:"yyyy-MM-dd"', width: '10%' },
            { name: 'address', displayName: 'Address', type: 'object', cellFilter: 'address', width: '20%' },
            { name: 'address.city', displayName: 'Address', width: '10%',
                cellEditableCondition: function($scope){
                    return $scope.rowRenderIndex%2
                }
            },
            { name: 'isActive', displayName: 'Active', type: 'boolean', width: '10%' },
            { name: 'filename', displayName: 'File', width: '10%',enableCellEdit: false, cellTemplate : '<a class="delet-ng" href="" ng-click="grid.appScope.delet(row.entity);">删除</a>'}
        ];
        $scope.msg = {};
        $scope.gridOptions.onRegisterApi = function(gridApi){
            //set gridApi on scope
            $scope.gridApi = gridApi;
            gridApi.edit.on.afterCellEdit($scope,function(rowEntity, colDef, newValue, oldValue){
                $scope.msg.lastCellEdited = 'edited row id:' + rowEntity.id + ' Column:' + colDef.name + ' newValue:' + newValue + ' oldValue:' + oldValue ;
                $scope.$apply();
            });
        };

        $http.get(getRequestUrl("table"))
            .success(function(data) {
                for(i = 0; i < data.length; i++){
                    data[i].registered = new Date(data[i].registered);
                    data[i].gender = data[i].gender==='male' ? 1 : 2;
                    if (i % 2) {
                        data[i].pet = 'fish'
                        data[i].foo = {bar: [{baz: 2, options: [{value: 'fish'}, {value: 'hamster'}]}]}
                    }
                    else {
                        data[i].pet = 'dog'
                        data[i].foo = {bar: [{baz: 2, options: [{value: 'dog'}, {value: 'cat'}]}]}
                    }
                }
                $scope.gridOptions.data = data;
                $scope.add_table = function () {
                    var data_zi = {
                        "guid": "",
                        "isActive": "",
                        "balance": "",
                        "picture": "",
                        "age": "",
                        "name": "",
                        "gender": "",
                        "company": "",
                        "email": "",
                        "phone": "",
                        "address": {
                            "street": 317,
                            "city": "Blairstown",
                            "state": "Maine",
                            "zip": 390
                        },
                        "about": "",
                        "registered": "",
                        "friends": [
                            {
                                "id": 0,
                                "name": "Rosanne Barrett"
                            },
                            {
                                "id": 1,
                                "name": "Nita Chase"
                            },
                            {
                                "id": 2,
                                "name": "Briggs Stark"
                            }
                        ]
                    };
                    $scope.gridOptions.data.unshift(data_zi);
                }
            });
    }])

        .filter('mapGender', function() {
            var genderHash = {
                1: 'male',
                2: 'female'
            };

            return function(input) {
                if (!input){
                    return '';
                } else {
                    return genderHash[input];
                }
            };
        })

        .filter('mapStatus', function() {
            var genderHash = {
                1: 'Bachelor',
                2: 'Nubile',
                3: 'Married'
            };

            return function(input) {
                if (!input){
                    return '';
                } else {
                    return genderHash[input];
                }
            };
        });
    //*--------------------------------公用表格模块end------------------------------------------//
</script>
</html>